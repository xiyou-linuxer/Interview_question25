## 有趣！被 const 操控的指针

请分析程序输出，并解释原因。
被注释掉的代码，如果取消注释会发生什么？

```c
#include <stdio.h>

int main()
{
    int arr[] = {10, 20, 30, 40, 50};
    int a = 100, b = 200;


    int *const ptr1 = &a;
    const int *ptr2 = &b;
    const int *const ptr3 = &b;

    printf("a=%d, b=%d\n", a, b);

    *ptr1 = 150;
    printf("a=%d, b=%d\n", a, b);
    // ptr1 = &b;
    ptr2 = &a;
    printf("*ptr2=%d\n", *ptr2);
    //*ptr2 = 250;

    printf("*ptr3=%d\n", *ptr3);
    // *ptr3 = 300;
    // ptr3 = &a;
    int *arr_ptr = arr;
    printf("数组元素: %d, %d, %d\n", *arr_ptr, *(arr_ptr + 2), arr_ptr[4]);

    return 0;
}

```

---

| **出题人** | **王力扬**         |
| ---------- | ------------------ |
| 知识点 1   | 指针常量与常量指针 |
| 知识点 2   | 指针的解引用       |

---

Q1.解释每一个 printf

Q2.解释注释掉的代码

---

A1：

-   **第一个 printf 语句：**

    ```c
    printf("a=%d, b=%d\n", a, b);
    ```

    输出：`a=100, b=200`
    解释：在代码开始时，变量`a`被初始化为 100，变量`b`被初始化为 200。因此，打印的是`a`和`b`的初始值。

-   **第二个 printf 语句：**

    ```c
    printf("a=%d, b=%d\n", a, b);
    ```

    输出：`a=150, b=200`
    解释：在此之前，执行了`*ptr1 = 150;`。`ptr1`是一个指针常量（`int *const ptr1`），它指向`a`。因此，通过`*ptr1`修改了`a`的值为 150。`b`的值保持不变，仍为 200。

-   **第三个 printf 语句：**

    ```c
    printf("*ptr2=%d\n", *ptr2);
    ```

    输出：`*ptr2=150`
    解释：在此之前，执行了`ptr2 = &a;`。`ptr2`是一个常量指针（`const int *ptr2`），意味着它可以被重新指向其他地址，但不能通过它修改所指向的值。这里`ptr2`被重新指向`a`，而`a`的值是 150，因此`*ptr2`打印 150。

-   **第四个 printf 语句：**

    ```c
    printf("*ptr3=%d\n", *ptr3);
    ```

    输出：`*ptr3=200`
    解释：`ptr3`是一个指向常量的指针常量（`const int *const ptr3`），它被初始化为指向`b`。`b`的值是 200，且`ptr3`的指向和值都不能修改，因此`*ptr3`打印 200。

-   **第五个 printf 语句：**
    ```c
    printf("数组元素: %d, %d, %d\n", *arr_ptr, *(arr_ptr + 2), arr_ptr[4]);
    ```
    输出：`数组元素: 10, 30, 50`
    解释：`arr_ptr`指向数组`arr`的首元素。`*arr_ptr`是`arr[0]`（值为 10），`*(arr_ptr + 2)`是`arr[2]`（值为 30），`arr_ptr[4]`是`arr[4]`（值为 50）。

A2：

-   `// ptr1 = &b;`
    解释：`ptr1`是指针常量（`int *const ptr1`），意味着`ptr1`本身的值（即指向的地址）不能被修改。尝试将`ptr1`重新指向`b`会导致编译错误，因此这行被注释掉。

-   `//*ptr2 = 250;`
    解释：`ptr2`是常量指针（`const int *ptr2`），意味着通过`ptr2`不能修改所指向的值。尝试通过`ptr2`赋值（如`*ptr2 = 250`）会导致编译错误，因此这行被注释掉。

-   `// *ptr3 = 300;`
    解释：`ptr3`是指向常量的指针常量（`const int *const ptr3`），意味着既不能修改`ptr3`的指向，也不能通过`ptr3`修改所指向的值。尝试通过`ptr3`赋值（如`*ptr3 = 300`）会导致编译错误，因此这行被注释掉。

-   `// ptr3 = &a;`
    解释：同样，`ptr3`的指向不能被修改。尝试将`ptr3`重新指向`a`会导致编译错误，因此这行被注释掉。
