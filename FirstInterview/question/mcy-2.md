#### 2.Welcome to xiyoulinux

说说每一行的输出是什么并尝试解释一下原理

```c
int main() {
    char a[] = "Welcome to xiyoulinux";
    char b[] = "Welcome to xiyoulinux";
    char c[] = {'W','e','l','c','o','m','e',' ','t','o',' ',
                'x','i','y','o','u','l','i','n','u','x'};
    char d[100] = "Welcome to xiyoulinux";
    const char *e = "Welcome to xiyoulinux";
    printf("1.%d,%d\n", a == b,strcmp(a, b));
    printf("2.%lu vs %lu\n", sizeof(a), sizeof(c)); 
    printf("3.%lu vs %lu\n", sizeof(a), sizeof(d));
    printf("4.%lu vs %lu\n", strlen(a), strlen(d));
    printf("5.%lu vs %lu\n", sizeof(a), sizeof(e));
    return 0;
}
```

------


| **出题人** | **孟昶羽**   |
| ---------- | ------------ |
| 知识点1    | 内存布局 |
| 知识点2    | 关键字sizeof和函数strlen的区别 |
| 知识点3    | 指针初始化的字符串常量 |
| 知识点4    | 手动初始化字符数组 |


------

Q1. 程序每一行的输出是什么，为什么是这样？50%

Q2. 你了解进程的虚拟内存分区吗，指针 a 和 b 指向进程的虚拟内存中的哪个区域？15%

Q3. 变量 e 为什么需要使用 const 关键字进行修饰，可以去掉吗，去掉会导致什么后果？15% 

Q4. 请你详细讲讲strcmp() 、sizeof 和 strlen。20%

```
A1：
1. 输出：0,0  
   - a == b 比较的是两个数组首地址，a 和 b 是不同的数组，位于不同的栈空间，所以结果是 `0`。  
   - strcmp(a, b) 比较的是字符串内容，两者内容完全相同，因此结果是 0。  

2. 输出：22 vs 21  
   - a 是用字符串字面值初始化的字符数组，包含末尾的 '\0'，所以 sizeof(a) = 22。  
   - c 是手动写的字符数组，没有加 '\0'，所以 sizeof(c) = 21。  

3. 输出：22 vs 100  
   - a 的大小仍然是 22。  
   - d 是固定长度 100 的数组，即使只初始化了前 22 个字符，其余自动填充 0，所以 sizeof(d) = 100。  

4. 输出：21 vs 21  
   - strlen(a) 计算的是字符串的实际长度（不包括末尾 '\0'），所以结果是 21。  
   - strlen(d) 也是 21，因为初始化后前 22 个字符和 a 一样，剩余位置都是 0，第一个 '\0' 在同样位置。  

5. 输出：22 vs 8（假设 64 位机器）  
   - sizeof(a) = 22，因为数组大小是编译期确定的。  
   - sizeof(e) 只是一个指针大小，64 位下是 8。  


A2：  
进程虚拟内存分区大致包括：代码段、数据段、堆、栈，以及只读的字符串常量区。  
- a 和 b 是数组，存放在栈区（因为它们是局部变量）。  
- 但它们的内容初始化来源于只读的字符串常量区，编译器拷贝常量到数组中。  
所以：a 和 b 分别指向栈区的不同数组。   

A3：  
- e 是一个指针，指向字符串常量 "Welcome to xiyoulinux"，这个常量位于只读存储区。  
- 使用 const 修饰，是为了防止通过 e 修改只读区的内容，否则会导致未定义行为（通常是段错误）。  
- 如果去掉 const，编译器可能会报 warning，但仍然允许编译；运行时如果执行写操作，可能会直接崩溃。  

A4：  
- strcmp(s1, s2) 
  比较两个以 '\0' 结尾的字符串的内容：  
  - 返回 0 表示相等  
  - 返回 <0 表示 `s1 < s2`  
  - 返回 >0 表示 `s1 > s2`  
  比较方式是逐字符按 ASCII 值对比。  

- sizeof
  编译器运算符，是一个关键字，返回对象或类型所占的字节数。  
  - 数组：返回整个数组大小  
  - 指针：返回指针本身大小（与指针指向内容无关）  
  - sizeof 在编译期确定结果，不需要实际运行。  

- strlen 
  运行期函数，计算字符串的实际长度（不包含末尾 '\0'）。  
  原理是从首地址开始扫描，直到遇到 '\0' 为止。  

```